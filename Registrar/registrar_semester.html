<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Semester Management</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="header">
  <div class="logo"><img src="images/logo.png" class="logo-img"><small>Digital Academic Operating System</small></div>
  <div class="user-info">Registrar | Ms. Ana Cruz <button class="logout-btn" onclick="logout()">Logout</button></div>
</div>
<div class="container">
  <div class="sidebar">
    <h4>REGISTRAR</h4>
    <a href="registrar_profile.html">My Profile</a>
    <a href="registrar_dashboard.html">Dashboard</a>
    <a href="registrar_students.html">Student Records</a>
    <a href="registrar_faculty.html">Faculty Records</a>
    <a href="registrar_grades.html">Grade Evaluation</a>
    <h4 style="margin-top:16px;font-size:10px;letter-spacing:1px;opacity:.7;">MANAGEMENT</h4>
    <a href="registrar_college.html">Colleges</a>
    <a href="registrar_course.html">Courses</a>
    <a href="registrar_subject.html">Subjects</a>
    <a href="registrar_yearlevel.html">Year Levels</a>
    <a href="registrar_semester.html" class="active">Semesters</a>
    <a href="registrar_section.html">Sections</a>
    <a href="registrar_academic.html">Academic Year</a>
    <h4 style="margin-top:16px;font-size:10px;letter-spacing:1px;opacity:.7;">RECORDS</h4>
    <a href="registrar_parents.html">Parents</a>
    <a href="registrar_employees.html">Employees</a>
    <a href="registrar_admission.html">Admission</a>
    <h4 style="margin-top:16px;font-size:10px;letter-spacing:1px;opacity:.7;">OTHERS</h4>
    <a href="registrar_reports.html">Reports</a>
    <a href="registrar_logs.html">User Logs</a>
    <a href="registrar_roles.html">Roles & Permissions</a>
  </div>
  <div class="content">
    <h2>Semester Management</h2>
    <button class="add-btn" onclick="openModal()">+ Add Semester</button>
    <table>
      <thead><tr><th>Semester</th><th>Academic Year</th><th>Start Date</th><th>End Date</th><th>Status</th><th>Actions</th></tr></thead>
      <tbody id="semTable"></tbody>
    </table>
  </div>
</div>

<div id="modal" class="modal">
  <div class="modal-content" style="width:480px;">
    <h3 id="modalTitle">Add Semester</h3>
    <input type="hidden" id="editIndex">
    <div class="modal-section">
      <div class="modal-section-title">Semester Information</div>
      <div class="form-row col2">
        <div class="field"><label>Semester</label>
          <select id="sSem">
            <option>1st Semester</option>
            <option>2nd Semester</option>
            <option>Summer</option>
          </select>
        </div>
        <div class="field"><label>Academic Year</label>
          <select id="sAY"><option value="">-- Select --</option></select>
        </div>
      </div>
      <div class="form-row col2">
        <div class="field"><label>Start Date</label><input type="date" id="sStart"></div>
        <div class="field"><label>End Date</label><input type="date" id="sEnd"></div>
      </div>
      <div class="form-row">
        <div class="field"><label>Status</label>
          <select id="sStatus">
            <option value="Active">Active</option>
            <option value="Upcoming">Upcoming</option>
            <option value="Inactive">Inactive</option>
          </select>
        </div>
      </div>
    </div>
    <button class="enroll-btn" onclick="saveSem()">Save Semester</button>
    <button class="danger enroll-btn" onclick="closeModal()" style="margin-top:8px;">Cancel</button>
  </div>
</div>

<script>
let semesters = JSON.parse(localStorage.getItem("semesters")) || [];

function populateAY(){
  const ays = JSON.parse(localStorage.getItem("academicYears"))||[];
  const sel = document.getElementById("sAY");
  sel.innerHTML = `<option value="">-- Select AY --</option>` + ays.map(a=>`<option>${a.year}</option>`).join("");
}

function render(){
  const tbody = document.getElementById("semTable");
  if(!semesters.length){ tbody.innerHTML=`<tr><td colspan="6" class="empty-note">No semesters yet.</td></tr>`; return; }
  tbody.innerHTML = semesters.map((s,i)=>{
    const cls = s.status==="Active"?"sem-active":s.status==="Upcoming"?"sem-upcoming":"sem-inactive";
    return `<tr>
      <td><strong>${s.sem}</strong></td>
      <td>${s.ay||'—'}</td>
      <td>${s.start||'—'}</td>
      <td>${s.end||'—'}</td>
      <td><span class="sem-status ${cls}">${s.status||'Inactive'}</span></td>
      <td>
        <button onclick="editSem(${i})">Edit</button>
        <button class="danger" onclick="deleteSem(${i})">Delete</button>
      </td>
    </tr>`;
  }).join("");
}

function openModal(){ clearForm(); document.getElementById("modalTitle").textContent="Add Semester"; document.getElementById("modal").style.display="flex"; }
function closeModal(){ document.getElementById("modal").style.display="none"; }
function clearForm(){ document.getElementById("sSem").value="1st Semester"; document.getElementById("sAY").value=""; document.getElementById("sStart").value=""; document.getElementById("sEnd").value=""; document.getElementById("sStatus").value="Active"; document.getElementById("editIndex").value=""; }

function saveSem(){
  const data = { sem:document.getElementById("sSem").value, ay:document.getElementById("sAY").value, start:document.getElementById("sStart").value, end:document.getElementById("sEnd").value, status:document.getElementById("sStatus").value };
  const idx = document.getElementById("editIndex").value;
  if(idx==="") semesters.push(data); else semesters[parseInt(idx)]=data;
  localStorage.setItem("semesters", JSON.stringify(semesters));
  closeModal(); render();
}

function editSem(i){
  const s = semesters[i];
  document.getElementById("modalTitle").textContent="Edit Semester";
  document.getElementById("editIndex").value=i;
  document.getElementById("sSem").value   = s.sem;
  document.getElementById("sAY").value    = s.ay||"";
  document.getElementById("sStart").value = s.start||"";
  document.getElementById("sEnd").value   = s.end||"";
  document.getElementById("sStatus").value= s.status||"Active";
  document.getElementById("modal").style.display="flex";
}

function deleteSem(i){ if(confirm("Delete this semester?")){ semesters.splice(i,1); localStorage.setItem("semesters",JSON.stringify(semesters)); render(); } }
function logout(){ window.location.href="login.html"; }
document.getElementById("modal").addEventListener("click",function(e){ if(e.target===this) closeModal(); });
populateAY(); render();
</script>
</body>
</html>